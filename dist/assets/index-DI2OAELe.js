var Pe=Object.defineProperty;var xe=(s,e,t)=>e in s?Pe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var v=(s,e,t)=>xe(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();class te{constructor(e=4){v(this,"size");v(this,"cells");this.size=e,this.cells=Array.from({length:e},()=>Array.from({length:e},()=>0))}clone(){const e=new te(this.size);return e.cells=this.cells.map(t=>t.slice()),e}loadFrom(e){if(e.length!==this.size||e.some(t=>t.length!==this.size))throw new Error("Dimensão inválida para loadFrom");for(let t=0;t<this.size;t++)for(let i=0;i<this.size;i++)this.cells[t][i]=e[t][i]}reset(){for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)this.cells[e][t]=0;this.spawn(),this.spawn()}emptyPositions(){const e=[];for(let t=0;t<this.size;t++)for(let i=0;i<this.size;i++)this.cells[t][i]===0&&e.push([t,i]);return e}spawn(){const e=this.emptyPositions();if(!e.length)return;const[t,i]=e[Math.floor(Math.random()*e.length)];this.cells[t][i]=Math.random()<.9?2:4}spawnWithReturn(){const e=this.emptyPositions();if(!e.length)return;const[t,i]=e[Math.floor(Math.random()*e.length)],a=Math.random()<.9?2:4;return this.cells[t][i]=a,{at:{r:t,c:i},value:a}}canMove(){if(this.emptyPositions().length>0)return!0;for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++){const i=this.cells[e][t];if(e+1<this.size&&this.cells[e+1][t]===i||t+1<this.size&&this.cells[e][t+1]===i)return!0}return!1}move(e){const t=this.moveWithTrace(e);return{moved:t.moved,scoreDelta:t.scoreDelta,merged:t.merged}}moveWithTrace(e){const t=this.size,i=this.clone().cells;let a=!1,n=0,o=!1;const r=[],c=[],d=(l,h)=>e==="left"?[l,h]:e==="right"?[l,t-1-h]:e==="up"?[h,l]:[t-1-h,l],m=(l,h,f)=>{e==="left"?this.cells[l][h]=f:e==="right"?this.cells[l][t-1-h]=f:e==="up"?this.cells[h][l]=f:this.cells[t-1-h][l]=f};for(let l=0;l<t;l++){const h=[],f=[];for(let L=0;L<t;L++){const[k,A]=d(l,L),I=i[k][A];I!==0&&(h.push(I),f.push({r:k,c:A}))}const y=[],E=[];let w=0;for(;w<h.length;)if(w+1<h.length&&h[w]===h[w+1]){const L=h[w]*2;y.push(L),E.push([w,w+1]),n+=L,o=!0,w+=2}else y.push(h[w]),E.push([w]),w+=1;for(;y.length<t;)y.push(0),E.push([]);for(let L=0;L<t;L++){const[k,A]=d(l,L),I=y[L];m(l,L,I);const O=E[L];if(O.length===1){const _=O[0],p=f[_],b={r:k,c:A};p.r===b.r&&p.c===b.c||(a=!0,r.push({from:p,to:b,value:h[_]}))}else if(O.length===2){const _=O[0],p=O[1],b=f[_],T=f[p],S={r:k,c:A};(!(b.r===S.r&&b.c===S.c)||!(T.r===S.r&&T.c===S.c))&&(a=!0),r.push({from:b,to:S,value:h[_]}),r.push({from:T,to:S,value:h[p],mergedPiece:!0}),c.push({at:S,newValue:I})}}}let u;return a&&(u=this.spawnWithReturn()),{moved:a,scoreDelta:n,merged:o,moves:r,merges:c,spawn:u}}}const Re={2:"#0e4a63",4:"#10627e",8:"#1280a3",16:"#14a0c9",32:"#16c0ef",64:"#18d2ff",128:"#1df0e0",256:"#13d695",512:"#0ecf8b",1024:"#70f0a8",2048:"#bafbd7"},Be="#eaf7ff",Me="#141b24",Ne="#1c2430",De="#253140";function Ue(s,e){return e?{2:"8-bit",4:"16-bit",8:"32-bit",16:"64-bit",32:"128-bit",64:"256-bit",128:"512-bit",256:"1 KB",512:"2 KB",1024:"1 MB",2048:"2 MB"}[s]??String(s):String(s)}class Ge{constructor(e){v(this,"canvas");v(this,"ctx");v(this,"board",new te(4));v(this,"tileGap",12);v(this,"score",0);v(this,"best",0);v(this,"useLabels",!1);v(this,"sfx");v(this,"anim",{phase:"idle",t:0,duration:0});v(this,"rafId",null);v(this,"inputLocked",!1);v(this,"SLIDE_MS",180);v(this,"POP_MS",110);v(this,"TRAIL_STEPS",3);v(this,"TRAIL_ALPHA",.18);v(this,"SQUASH_MAX",.12);v(this,"tick",()=>{var i,a;const e=performance.now();this._phaseStamp!==this.anim.phase&&(this._phaseStamp=this.anim.phase,this._last=e),this._last===void 0&&(this._last=e);let t=e-this._last;if(t=Math.max(0,Math.min(t,1e3/30)),this._last=e,this.anim.phase==="idle"){this.rafId=null,this.render();return}if(this.anim.t+=t,this.anim.t>=this.anim.duration)if(this.anim.phase==="slide")this.anim.merges&&this.anim.merges.length>0&&((i=this.sfx)==null||i.merge(1)),this.anim={phase:"mergePop",t:0,duration:this.POP_MS,toCells:this.board.cells.map(n=>n.slice()),merges:this.anim.merges,spawn:this.anim.spawn};else if(this.anim.phase==="mergePop")this.anim.spawn&&((a=this.sfx)==null||a.spawn()),this.anim={phase:"spawnPop",t:0,duration:this.POP_MS,toCells:this.board.cells.map(n=>n.slice()),spawn:this.anim.spawn};else{this.anim={phase:"idle",t:0,duration:0},this.inputLocked=!1,this.render(),this.rafId=null;return}this.renderPhaseOnly(),this.rafId=requestAnimationFrame(this.tick)});const t=e.getContext("2d");if(!t)throw new Error("Canvas 2D não suportado");this.canvas=e,this.ctx=t,this.fitCanvas(),window.addEventListener("resize",()=>this.fitCanvas())}setSFX(e){this.sfx=e}snapshot(){return{score:this.score,cells:this.board.cells.map(e=>e.slice())}}setBest(e){this.best=e}setLabels(e){this.useLabels=e}newGame(){this.stopAnim(),this.score=0,this.board.reset(),this.render()}step(e){var a;if(this.inputLocked)return;const t=this.board.clone().cells.map(n=>n.slice()),i=this.board.moveWithTrace(e);if(!i.moved){this.render();return}this.score+=i.scoreDelta,(a=this.sfx)==null||a.move(),this.anim={phase:"slide",t:0,duration:this.SLIDE_MS,fromCells:t,toCells:this.board.cells.map(n=>n.slice()),moves:i.moves,merges:i.merges,spawn:i.spawn},this.inputLocked=!0,this._last=void 0,this._phaseStamp=this.anim.phase,this.tick()}fitCanvas(){const e=this.canvas.getBoundingClientRect(),t=Math.min(e.width,640);this.canvas.width=Math.floor(t),this.canvas.height=Math.floor(t),this.render()}render(){const{ctx:e}=this;e.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawGrid();const t=this.board.size;for(let i=0;i<t;i++)for(let a=0;a<t;a++){const n=this.board.cells[i][a];if(n>0){const{x:o,y:r,s:c}=this.cellRect(i,a);this.drawTile(o,r,c,n,1)}}this.anim.phase!=="idle"&&this.renderAnim()}renderAnim(){const e=this.anim,t=Math.min(1,e.duration?e.t/e.duration:1);if(e.phase==="slide"){const i=e.fromCells??e.toCells??this.board.cells,a=e.moves??[],n=new Set(a.map(r=>`${r.from.r}:${r.from.c}`));this.drawGrid();const o=this.board.size;for(let r=0;r<o;r++)for(let c=0;c<o;c++){if(n.has(`${r}:${c}`))continue;const d=i[r][c];if(d>0){const{x:m,y:u,s:l}=this.cellRect(r,c);this.drawTile(m,u,l,d,1)}}for(const r of a){const{x:c,y:d,s:m}=this.cellRect(r.from.r,r.from.c),{x:u,y:l}=this.cellRect(r.to.r,r.to.c),h=this.easeOutCubic(t),f=c+(u-c)*h,y=d+(l-d)*h,E=Math.abs(u-c)>Math.abs(l-d),w=this.SQUASH_MAX*(1-this.easeOutCubic(t)),L=E?1+w:1-w/2,k=E?1-w/2:1+w;for(let A=1;A<=this.TRAIL_STEPS;A++){const I=h-A*(1/(this.TRAIL_STEPS+1));if(I<=0)continue;const O=c+(u-c)*I,_=d+(l-d)*I,p=this.TRAIL_ALPHA*(1-A/(this.TRAIL_STEPS+1));this.drawTileEx(O,_,m,r.value,{alpha:p})}this.drawTileEx(f,y,m,r.value,{scaleX:L,scaleY:k})}return}if(e.phase==="mergePop"){const i=e.toCells??e.fromCells??this.board.cells,a=e.merges??[];this.drawGrid();const n=this.board.size;for(let o=0;o<n;o++)for(let r=0;r<n;r++){const c=i[o][r];if(c>0){const{x:d,y:m,s:u}=this.cellRect(o,r),h=a.find(f=>f.at.r===o&&f.at.c===r)?1+.15*(1-this.easeOutCubic(1-t)):1;this.drawTile(d,m,u,c,h)}}return}if(e.phase==="spawnPop"){const i=e.toCells??e.fromCells??this.board.cells;this.drawGrid();const a=this.board.size;for(let n=0;n<a;n++)for(let o=0;o<a;o++){const r=i[n][o];if(r>0){const{x:c,y:d,s:m}=this.cellRect(n,o);let u=1;e.spawn&&e.spawn.at.r===n&&e.spawn.at.c===o&&(u=.2+.8*this.easeOutCubic(t)),this.drawTile(c,d,m,r,u)}}return}}renderPhaseOnly(){const{ctx:e}=this;e.clearRect(0,0,this.canvas.width,this.canvas.height),this.anim.phase==="idle"?this.render():this.renderAnim()}stopAnim(){this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.anim={phase:"idle",t:0,duration:0},this.inputLocked=!1}cellRect(e,t){const i=this.canvas.width,a=this.board.size,n=this.tileGap,o=(i-n*(a+1))/a,r=n+t*(o+n),c=n+e*(o+n);return{x:r,y:c,s:o}}drawGrid(){const{ctx:e}=this,t=this.canvas.width,i=this.canvas.height,a=this.board.size,n=this.tileGap,o=(t-n*(a+1))/a;e.fillStyle=Me,this.roundRect(e,0,0,t,i,18),e.fill(),e.fillStyle="#0f1520";for(let r=0;r<a;r++)for(let c=0;c<a;c++){const d=n+c*(o+n),m=n+r*(o+n);this.roundRect(e,d,m,o,o,12),e.fill(),e.strokeStyle="#1a2330",e.lineWidth=1,e.stroke()}}drawTile(e,t,i,a,n=1){this.drawTileEx(e,t,i,a,{scale:n})}drawTileEx(e,t,i,a,n){const{ctx:o}=this,r=(n==null?void 0:n.scaleX)??(n==null?void 0:n.scale)??1,c=(n==null?void 0:n.scaleY)??(n==null?void 0:n.scale)??1,d=(n==null?void 0:n.alpha)??1;o.save(),o.globalAlpha=d;const m=e+i/2,u=t+i/2;o.translate(m,u),o.scale(r,c),o.translate(-m,-u),o.fillStyle=Re[a]??Ne,this.roundRect(o,e,t,i,i,12),o.fill(),o.strokeStyle=De,o.lineWidth=1.5,o.stroke();const l=o.createLinearGradient(e,t,e,t+i);l.addColorStop(0,"rgba(255,255,255,.08)"),l.addColorStop(1,"rgba(0,0,0,.08)"),o.fillStyle=l,this.roundRect(o,e,t,i,i,12),o.fill(),o.fillStyle=Be,o.font=`${Math.floor(i*.32)}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial`,o.textAlign="center",o.textBaseline="middle";const h=Ue(a,this.useLabels);o.fillText(h,e+i/2,t+i/2),o.restore()}roundRect(e,t,i,a,n,o){const r=Math.min(o,a/2,n/2);e.beginPath(),e.moveTo(t+r,i),e.arcTo(t+a,i,t+a,i+n,r),e.arcTo(t+a,i+n,t,i+n,r),e.arcTo(t,i+n,t,i,r),e.arcTo(t,i,t+a,i,r),e.closePath()}easeOutCubic(e){return 1-Math.pow(1-e,3)}}function je(s){window.addEventListener("keydown",e=>{const t=e.key.toLowerCase();["arrowup","arrowdown","arrowleft","arrowright","w","a","s","d"].includes(t)&&e.preventDefault(),(t==="arrowup"||t==="w")&&s("up"),(t==="arrowdown"||t==="s")&&s("down"),(t==="arrowleft"||t==="a")&&s("left"),(t==="arrowright"||t==="d")&&s("right")})}function $e(s,e){let t=0,i=0,a=!1;const n=24;s.addEventListener("touchstart",o=>{a=!0;const r=o.touches[0];t=r.clientX,i=r.clientY,o.preventDefault()},{passive:!1}),s.addEventListener("touchmove",o=>{if(!a)return;o.preventDefault();const r=o.touches[0],c=r.clientX-t,d=r.clientY-i;Math.abs(c)<n&&Math.abs(d)<n||(a=!1,Math.abs(c)>Math.abs(d)?e(c>0?"right":"left"):e(d>0?"down":"up"))},{passive:!1}),s.addEventListener("touchend",o=>{a&&(a=!1,o.preventDefault())},{passive:!1})}const He="tech2048_best",we="tech2048_labels",se="tech2048_state",Ee="tech2048_sound",Le="tech2048_lang";function Fe(s){localStorage.setItem(He,String(s))}function We(){return localStorage.getItem(we)==="1"}function qe(s){localStorage.setItem(we,s?"1":"0")}function ze(){const s=localStorage.getItem(Ee);return s===null?!0:s==="1"}function Ke(s){localStorage.setItem(Ee,s?"1":"0")}function Ve(){return localStorage.getItem(Le)==="en"?"en":"pt-BR"}function Ye(s){localStorage.setItem(Le,s)}function Xe(){const s=localStorage.getItem(se);if(!s)return null;try{const e=JSON.parse(s);if(Array.isArray(e.cells)&&typeof e.score=="number")return e}catch{}return null}function Je(s){localStorage.setItem(se,JSON.stringify(s))}function Qe(){localStorage.removeItem(se)}class Ze{constructor(e=!0){v(this,"ctx",null);v(this,"enabled",!0);if(this.enabled=e,typeof window<"u"&&"AudioContext"in window)try{this.ctx=new AudioContext}catch{this.ctx=null}}beep(e=440,t=.08,i="sine",a=.06){if(!this.enabled||!this.ctx)return;const n=this.ctx.currentTime,o=this.ctx.createOscillator(),r=this.ctx.createGain();o.type=i,o.frequency.setValueAtTime(e,n),r.gain.setValueAtTime(a,n),r.gain.exponentialRampToValueAtTime(1e-4,n+t),o.connect(r).connect(this.ctx.destination),o.start(n),o.stop(n+t+.02)}move(){this.beep(320,.06,"square",.04)}merge(e=1){this.beep(520*e,.1,"triangle",.06)}spawn(){this.beep(220,.07,"sawtooth",.035)}}const Se={title:"2048 TECH",score:"Pontuação",best:"Recorde",newGame:"Novo jogo",labels:"Rótulos Tech",sound:"Sons",hint:"Use as setas do teclado (ou arraste no celular). Combine blocos iguais para chegar em 2048.",lang:"Idioma","alert.gameOver.title":"Fim de jogo","alert.gameOver.desc":"Pontuação: {score}","alert.gameOver.new":"Novo jogo","alert.gameOver.close":"Fechar","privacy.link":"Preferências de privacidade","consent.title":"Privacidade & Cookies","consent.essential.title":"Essenciais","consent.essential.desc":"Usamos armazenamento essencial para idioma, preferências do jogo e operação básica. (Sempre ativo)","consent.analytics.title":"Analíticos","consent.analytics.desc":"Ajuda a entender o uso do jogo para melhorar (ex.: métricas anônimas).","consent.ads.title":"Publicidade","consent.ads.desc":"Permite anúncios personalizados/medição. Desmarque para não personalizados ou sem anúncios.","consent.acceptAll":"Aceitar tudo","consent.onlyEssentials":"Somente essenciais"},et={title:"2048 TECH",score:"Score",best:"Best",newGame:"New Game",labels:"Tech Labels",sound:"Sound",hint:"Use arrow keys (or swipe on mobile). Merge equal tiles to reach 2048.",lang:"Language","alert.gameOver.title":"Game Over","alert.gameOver.desc":"Score: {score}","alert.gameOver.new":"New Game","alert.gameOver.close":"Close","privacy.link":"Privacy preferences","consent.title":"Privacy & Cookies","consent.essential.title":"Essential","consent.essential.desc":"We use essential storage for language, game prefs and core operation. (Always active)","consent.analytics.title":"Analytics","consent.analytics.desc":"Helps understand usage to improve (e.g., anonymous metrics).","consent.ads.title":"Advertising","consent.ads.desc":"Enables personalized ads/measurement. Uncheck for non-personalized or no ads.","consent.acceptAll":"Accept all","consent.onlyEssentials":"Only essentials"},tt={"pt-BR":Se,en:et};function G(s,e,t){let a=(tt[s]??Se)[e]??e;if(t)for(const[n,o]of Object.entries(t))a=a.replace(new RegExp(`\\{${n}\\}`,"g"),String(o));return a}function M(s){document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.dataset.i18n;e.innerText=G(s,t)})}function st(s,e){nt();const t=document.getElementById("modalOverlay"),i=document.getElementById("modalTitle"),a=document.getElementById("modalBody"),n=document.getElementById("modalPrimary"),o=document.getElementById("modalSecondary");return i.textContent=G(s,"alert.gameOver.title"),a.textContent=G(s,"alert.gameOver.desc",{score:e}),n.textContent=G(s,"alert.gameOver.new"),o.textContent=G(s,"alert.gameOver.close"),t.classList.remove("hidden"),t.classList.add("show"),new Promise(r=>{const c=l=>{t.classList.remove("show"),t.classList.add("hidden"),n.removeEventListener("click",d),o.removeEventListener("click",m),t.removeEventListener("click",u),r(l)},d=()=>c("new"),m=()=>c("close"),u=l=>{l.target===t&&c("close")};n.addEventListener("click",d),o.addEventListener("click",m),t.addEventListener("click",u,{once:!0})})}function nt(){if(document.getElementById("modalOverlay"))return;const s=document.createElement("div");s.id="modalOverlay",s.className="modal hidden",s.innerHTML=`
    <div class="modal-dialog">
      <div class="modal-header"><h3 id="modalTitle">Title</h3></div>
      <div class="modal-body"><p id="modalBody">Body</p></div>
      <div class="modal-actions"><button id="modalPrimary" class="btn primary">OK</button><button id="modalSecondary" class="btn ghost">Close</button></div>
    </div>`,document.body.appendChild(s)}function it(){if(document.getElementById("menuOverlay"))return;const s=document.createElement("div");s.id="menuOverlay",s.className="modal hidden",s.innerHTML=`
    <div class="modal-dialog" role="dialog" aria-labelledby="menuTitle">
      <div class="modal-header">
        <h3 id="menuTitle">Menu</h3>
      </div>
      <div class="modal-body">
        <div class="settings-list">
          <div class="settings-row">
            <label for="menuToggleLabels"><span data-i18n="labels">Rótulos Tech</span></label>
            <input type="checkbox" id="menuToggleLabels">
          </div>
          <div class="settings-row">
            <label for="menuToggleSound"><span data-i18n="sound">Sons</span></label>
            <input type="checkbox" id="menuToggleSound">
          </div>
          <div class="settings-row">
            <label for="menuLangSelect"><span data-i18n="lang">Idioma</span></label>
            <select id="menuLangSelect">
              <option value="pt-BR">pt-BR</option>
              <option value="en">English</option>
            </select>
          </div>
          <div class="settings-row">
            <button id="menuNewGame" class="btn" data-i18n="newGame">Novo jogo</button>
            <button id="menuClose" class="btn ghost">Fechar</button>
          </div>
        </div>
      </div>
    </div>`,document.body.appendChild(s)}function at(){const s=document.getElementById("menuOverlay");s==null||s.classList.remove("hidden"),s==null||s.classList.add("show")}function ne(){const s=document.getElementById("menuOverlay");s==null||s.classList.remove("show"),s==null||s.classList.add("hidden")}const oe="tech2048_mobile_attempts";class ot{constructor(e){v(this,"cfg");this.cfg={mobileFrequency:3,...e}}initDesktopBanner(){const e=document.getElementById("adSidebarSlot");if(e instanceof HTMLElement&&!e.querySelector("ins.adsbygoogle")){if(this.cfg.network==="adsense"&&this.cfg.adsenseClientId){this.injectAdSenseScriptOnce(this.cfg.adsenseClientId);const t=document.createElement("ins");t.className="adsbygoogle",t.style.display="block",t.style.width="300px",t.style.height="250px",t.setAttribute("data-ad-client",this.cfg.adsenseClientId),this.cfg.adsenseBannerSlotId&&t.setAttribute("data-ad-slot",this.cfg.adsenseBannerSlotId),e.appendChild(t),Array.isArray(window.adsbygoogle)?window.adsbygoogle.push({}):(window.adsbygoogle=[],window.adsbygoogle.push({}));return}e.innerHTML=this.cfg.bannerHTML??`
    <div class="ad-box">
      <div class="ad-placeholder">Seu banner 300×250 aqui</div>
    </div>`}}async maybeShowMobileInterstitial(){var n;if(!this.isMobile())return;const e=this.cfg.mobileFrequency??3,t=(parseInt(localStorage.getItem(oe)??"0",10)||0)+1;if(localStorage.setItem(oe,String(t)),t%e!==0)return;let i=document.getElementById("adInterstitial");i||(i=document.createElement("div"),i.id="adInterstitial",i.className="modal hidden",i.innerHTML=`
        <div class="modal-dialog" role="dialog" aria-labelledby="adTitle">
          <div class="modal-header">
            <h3 id="adTitle">Publicidade</h3>
          </div>
          <div class="modal-body">
            <div id="adInterstitialSlot" class="ad-box">
              <div class="ad-placeholder">Interstitial</div>
            </div>
          </div>
          <div class="modal-actions">
            <button id="adClose" class="btn ghost">Fechar</button>
          </div>
        </div>`,document.body.appendChild(i),i.addEventListener("click",o=>{o.target===i&&this.closeInterstitial()}),(n=document.getElementById("adClose"))==null||n.addEventListener("click",()=>this.closeInterstitial()));const a=document.getElementById("adInterstitialSlot");a.innerHTML="",this.cfg.network==="adsense"&&this.cfg.adsenseClientId?a.innerHTML=this.cfg.interstitialHTML??`
        <div class="ad-placeholder">Interstitial (HTML custom)</div>`:a.innerHTML=this.cfg.interstitialHTML??`
        <div class="ad-placeholder">Interstitial (HTML custom)</div>`,i.classList.remove("hidden"),i.classList.add("show"),await this.wait(50)}closeInterstitial(){const e=document.getElementById("adInterstitial");e&&(e.classList.remove("show"),e.classList.add("hidden"))}injectAdSenseScriptOnce(e){if(document.querySelector(`script[data-adsense="${e}"]`))return;const t=document.createElement("script");t.async=!0,t.src=`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${encodeURIComponent(e)}`,t.setAttribute("crossorigin","anonymous"),t.setAttribute("data-adsense",e),document.head.appendChild(t)}isMobile(){return window.matchMedia("(max-width: 899px)").matches}wait(e){return new Promise(t=>setTimeout(t,e))}}const Te="tech2048_consent_v1";function rt(){try{const s=localStorage.getItem(Te);return s?JSON.parse(s):null}catch{return null}}function re(s){localStorage.setItem(Te,JSON.stringify(s))}function Q(s){try{window.gtag&&window.gtag("consent","update",{ad_user_data:s.ad_user_data,ad_personalization:s.ad_personalization,ad_storage:s.ad_storage,analytics_storage:s.analytics_storage,functionality_storage:s.functionality_storage,security_storage:s.security_storage})}catch{}}function ct(s,e){const t=rt();if(t){Q(t),M(s),e==null||e(t.ad_storage==="granted"&&t.ad_user_data==="granted");return}Ae(s,e)}function lt(s){const e=document.getElementById("consentOverlay");if(e){e.classList.remove("hidden"),e.classList.add("show"),s&&M(s);return}s&&Ae(s)}function Ae(s,e){if(document.getElementById("consentOverlay")){const r=document.getElementById("consentOverlay");r.classList.remove("hidden"),r.classList.add("show"),M(s);return}const t=document.createElement("div");t.id="consentOverlay",t.className="modal show",t.innerHTML=`
    <div class="modal-dialog" role="dialog" aria-labelledby="consentTitle">
      <div class="modal-header">
        <h3 id="consentTitle" data-i18n="consent.title">Privacidade & Cookies</h3>
      </div>
      <div class="modal-body consent-body">
        <div class="consent-row">
          <div style="flex:1">
            <label data-i18n="consent.essential.title">Essenciais</label>
            <p data-i18n="consent.essential.desc">Usamos armazenamento essencial para idioma, preferências do jogo e operação básica. (Sempre ativo)</p>
          </div>
        </div>
        <div class="consent-row">
          <div style="flex:1">
            <label data-i18n="consent.analytics.title">Analíticos</label>
            <p data-i18n="consent.analytics.desc">Ajuda a entender o uso do jogo para melhorar (ex.: métricas anônimas).</p>
          </div>
          <div><input id="chkAnalytics" type="checkbox" /></div>
        </div>
        <div class="consent-row">
          <div style="flex:1">
            <label data-i18n="consent.ads.title">Publicidade</label>
            <p data-i18n="consent.ads.desc">Permite anúncios personalizados/medição. Desmarque para não personalizados ou sem anúncios.</p>
          </div>
          <div><input id="chkAds" type="checkbox" /></div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="btnReject" class="btn ghost inline" data-i18n="consent.onlyEssentials">Somente essenciais</button>
        <button id="btnAccept" class="btn primary inline" data-i18n="consent.acceptAll">Aceitar tudo</button>
      </div>
    </div>`,document.body.appendChild(t),M(s);const i=t.querySelector("#chkAnalytics"),a=t.querySelector("#chkAds");i.checked=!1,a.checked=!1;const n=()=>{t.classList.remove("show"),t.classList.add("hidden")};t.addEventListener("click",r=>{r.target===t&&n()}),t.querySelector("#btnAccept").addEventListener("click",()=>{const r={ad_user_data:"granted",ad_personalization:"granted",ad_storage:"granted",analytics_storage:"granted",functionality_storage:"granted",security_storage:"granted"};re(r),Q(r),n(),e==null||e(!0)}),t.querySelector("#btnReject").addEventListener("click",()=>{const r={ad_user_data:a.checked?"granted":"denied",ad_personalization:a.checked?"granted":"denied",ad_storage:a.checked?"granted":"denied",analytics_storage:i.checked?"granted":"denied",functionality_storage:"granted",security_storage:"granted"};re(r),Q(r),n(),e==null||e(r.ad_storage==="granted"&&r.ad_user_data==="granted")});const o=document.getElementById("privacyLink");o==null||o.addEventListener("click",()=>{t.classList.remove("hidden"),t.classList.add("show"),M(s)})}/*! Capacitor: https://capacitorjs.com/ - MIT License */var U;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(U||(U={}));class z extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const dt=s=>{var e,t;return s!=null&&s.androidBridge?"android":!((t=(e=s==null?void 0:s.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},ut=s=>{const e=s.CapacitorCustomPlatform||null,t=s.Capacitor||{},i=t.Plugins=t.Plugins||{},a=()=>e!==null?e.name:dt(s),n=()=>a()!=="web",o=u=>{const l=d.get(u);return!!(l!=null&&l.platforms.has(a())||r(u))},r=u=>{var l;return(l=t.PluginHeaders)===null||l===void 0?void 0:l.find(h=>h.name===u)},c=u=>s.console.error(u),d=new Map,m=(u,l={})=>{const h=d.get(u);if(h)return console.warn(`Capacitor plugin "${u}" already registered. Cannot register plugins twice.`),h.proxy;const f=a(),y=r(u);let E;const w=async()=>(!E&&f in l?E=typeof l[f]=="function"?E=await l[f]():E=l[f]:e!==null&&!E&&"web"in l&&(E=typeof l.web=="function"?E=await l.web():E=l.web),E),L=(p,b)=>{var T,S;if(y){const R=y==null?void 0:y.methods.find(C=>b===C.name);if(R)return R.rtype==="promise"?C=>t.nativePromise(u,b.toString(),C):(C,H)=>t.nativeCallback(u,b.toString(),C,H);if(p)return(T=p[b])===null||T===void 0?void 0:T.bind(p)}else{if(p)return(S=p[b])===null||S===void 0?void 0:S.bind(p);throw new z(`"${u}" plugin is not implemented on ${f}`,U.Unimplemented)}},k=p=>{let b;const T=(...S)=>{const R=w().then(C=>{const H=L(C,p);if(H){const F=H(...S);return b=F==null?void 0:F.remove,F}else throw new z(`"${u}.${p}()" is not implemented on ${f}`,U.Unimplemented)});return p==="addListener"&&(R.remove=async()=>b()),R};return T.toString=()=>`${p.toString()}() { [capacitor code] }`,Object.defineProperty(T,"name",{value:p,writable:!1,configurable:!1}),T},A=k("addListener"),I=k("removeListener"),O=(p,b)=>{const T=A({eventName:p},b),S=async()=>{const C=await T;I({eventName:p,callbackId:C},b)},R=new Promise(C=>T.then(()=>C({remove:S})));return R.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await S()},R},_=new Proxy({},{get(p,b){switch(b){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return y?O:A;case"removeListener":return I;default:return k(b)}}});return i[u]=_,d.set(u,{name:u,proxy:_,platforms:new Set([...Object.keys(l),...y?[f]:[]])}),_};return t.convertFileSrc||(t.convertFileSrc=u=>u),t.getPlatform=a,t.handleError=c,t.isNativePlatform=n,t.isPluginAvailable=o,t.registerPlugin=m,t.Exception=z,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ht=s=>s.Capacitor=ut(s),x=ht(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ie=x.registerPlugin;class Ie{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),i&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,i){const a=this.listeners[e];if(!a){if(i){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}return}a.forEach(n=>n(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new x.Exception(e,U.Unimplemented)}unavailable(e="not available"){return new x.Exception(e,U.Unavailable)}async removeListener(e,t){const i=this.listeners[e];if(!i)return;const a=i.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(i=>{this.notifyListeners(e,i)}))}}const ce=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),le=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class mt extends Ie{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[a,n]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=le(a).trim(),n=le(n).trim(),t[a]=n}),t}async setCookie(e){try{const t=ce(e.key),i=ce(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${a}; path=${n}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ie("CapacitorCookies",{web:()=>new mt});const ft=async s=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{const a=i.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},i.onerror=a=>t(a),i.readAsDataURL(s)}),gt=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(a=>a.toLocaleLowerCase()).reduce((a,n,o)=>(a[n]=s[e[o]],a),{})},pt=(s,e=!0)=>s?Object.entries(s).reduce((i,a)=>{const[n,o]=a;let r,c;return Array.isArray(o)?(c="",o.forEach(d=>{r=e?encodeURIComponent(d):d,c+=`${n}=${r}&`}),c.slice(0,-1)):(r=e?encodeURIComponent(o):o,c=`${n}=${r}`),`${i}&${c}`},"").substr(1):null,vt=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),a=gt(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(a.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[o,r]of Object.entries(s.data||{}))n.set(o,r);t.body=n.toString()}else if(a.includes("multipart/form-data")||s.data instanceof FormData){const n=new FormData;if(s.data instanceof FormData)s.data.forEach((r,c)=>{n.append(c,r)});else for(const r of Object.keys(s.data))n.append(r,s.data[r]);t.body=n;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(a.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class bt extends Ie{async request(e){const t=vt(e,e.webFetchExtra),i=pt(e.params,e.shouldEncodeUrlParams),a=i?`${e.url}?${i}`:e.url,n=await fetch(a,t),o=n.headers.get("content-type")||"";let{responseType:r="text"}=n.ok?e:{};o.includes("application/json")&&(r="json");let c,d;switch(r){case"arraybuffer":case"blob":d=await n.blob(),c=await ft(d);break;case"json":c=await n.json();break;case"document":case"text":default:c=await n.text()}const m={};return n.headers.forEach((u,l)=>{m[l]=u}),{data:c,headers:m,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}ie("CapacitorHttp",{web:()=>new bt});const yt="modulepreload",wt=function(s,e){return new URL(s,e).href},de={},Et=function(e,t,i){let a=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),c=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));a=Promise.allSettled(t.map(d=>{if(d=wt(d,i),d in de)return;de[d]=!0;const m=d.endsWith(".css"),u=m?'[rel="stylesheet"]':"";if(!!i)for(let f=o.length-1;f>=0;f--){const y=o[f];if(y.href===d&&(!m||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${u}`))return;const h=document.createElement("link");if(h.rel=m?"stylesheet":yt,m||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),m)return new Promise((f,y)=>{h.addEventListener("load",f),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(o){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=o,window.dispatchEvent(r),!r.defaultPrevented)throw o}return a.then(o=>{for(const r of o||[])r.status==="rejected"&&n(r.reason);return e().catch(n)})};var ue;(function(s){s.General="General",s.ParentalGuidance="ParentalGuidance",s.Teen="Teen",s.MatureAudience="MatureAudience"})(ue||(ue={}));var he;(function(s){s.SizeChanged="bannerAdSizeChanged",s.Loaded="bannerAdLoaded",s.FailedToLoad="bannerAdFailedToLoad",s.Opened="bannerAdOpened",s.Closed="bannerAdClosed",s.AdImpression="bannerAdImpression"})(he||(he={}));var Z;(function(s){s.TOP_CENTER="TOP_CENTER",s.CENTER="CENTER",s.BOTTOM_CENTER="BOTTOM_CENTER"})(Z||(Z={}));var ee;(function(s){s.BANNER="BANNER",s.FULL_BANNER="FULL_BANNER",s.LARGE_BANNER="LARGE_BANNER",s.MEDIUM_RECTANGLE="MEDIUM_RECTANGLE",s.LEADERBOARD="LEADERBOARD",s.ADAPTIVE_BANNER="ADAPTIVE_BANNER",s.SMART_BANNER="SMART_BANNER"})(ee||(ee={}));var me;(function(s){s.Loaded="interstitialAdLoaded",s.FailedToLoad="interstitialAdFailedToLoad",s.Showed="interstitialAdShowed",s.FailedToShow="interstitialAdFailedToShow",s.Dismissed="interstitialAdDismissed"})(me||(me={}));var fe;(function(s){s.Loaded="onRewardedInterstitialAdLoaded",s.FailedToLoad="onRewardedInterstitialAdFailedToLoad",s.Showed="onRewardedInterstitialAdShowed",s.FailedToShow="onRewardedInterstitialAdFailedToShow",s.Dismissed="onRewardedInterstitialAdDismissed",s.Rewarded="onRewardedInterstitialAdReward"})(fe||(fe={}));var ge;(function(s){s.Loaded="onRewardedVideoAdLoaded",s.FailedToLoad="onRewardedVideoAdFailedToLoad",s.Showed="onRewardedVideoAdShowed",s.FailedToShow="onRewardedVideoAdFailedToShow",s.Dismissed="onRewardedVideoAdDismissed",s.Rewarded="onRewardedVideoAdReward"})(ge||(ge={}));var pe;(function(s){s.NOT_REQUIRED="NOT_REQUIRED",s.OBTAINED="OBTAINED",s.REQUIRED="REQUIRED",s.UNKNOWN="UNKNOWN"})(pe||(pe={}));var ve;(function(s){s[s.DISABLED=0]="DISABLED",s[s.EEA=1]="EEA",s[s.NOT_EEA=2]="NOT_EEA"})(ve||(ve={}));const ke=ie("AdMob",{web:()=>Et(()=>import("./web-ZviP6SyQ.js"),[],import.meta.url).then(s=>new s.AdMobWeb)}),Lt="ca-app-pub-3940256099942544/6300978111";function _e(){return x.isNativePlatform()}async function St(){_e()&&await ke.initialize({initializeForTesting:!0})}async function Tt(s){if(!_e())return;const e={adId:Lt,adSize:ee.SMART_BANNER,position:Z.BOTTOM_CENTER,margin:0};await ke.showBanner(e)}const Ce=document.getElementById("game"),At=document.getElementById("score"),It=document.getElementById("best"),K=document.getElementById("newGame"),V=document.getElementById("btnMenu"),q=new Ze,g=new Ge(Ce);g.setSFX(q);g.setLabels(We());q.enabled=ze();let P=Ve();M(P);function B(){At.textContent=String(g.score),g.score>g.best&&(g.setBest(g.score),Fe(g.best),It.textContent=String(g.best))}it();const W=document.getElementById("menuOverlay"),N=document.getElementById("menuToggleLabels"),D=document.getElementById("menuToggleSound"),j=document.getElementById("menuLangSelect"),Y=document.getElementById("menuNewGame"),X=document.getElementById("menuClose");V==null||V.addEventListener("click",()=>{N.checked=g.useLabels??!1,D.checked=q.enabled??!0,j.value=P,at()});W==null||W.addEventListener("click",s=>{s.target===W&&ne()});X==null||X.addEventListener("click",()=>ne());N==null||N.addEventListener("change",()=>{g.setLabels(N.checked),qe(N.checked),g.render()});D==null||D.addEventListener("change",()=>{q.enabled=D.checked,Ke(D.checked)});j==null||j.addEventListener("change",()=>{P=j.value,Ye(P),M(P)});const $=new ot({network:"adsense",adsenseClientId:"ca-pub-8826867524630571",adsenseBannerSlotId:"2306720556",bannerHTML:`
    <a href="https://example.com" target="_blank" rel="noopener" class="ad-box" style="display:block;text-decoration:none">
      <div class="ad-placeholder">Seu banner 300×250</div>
    </a>
  `,interstitialHTML:`
    <a href="https://example.com" target="_blank" rel="noopener" class="ad-box" style="display:block;text-decoration:none">
      <div class="ad-placeholder">Interstitial promo</div>
    </a>
  `,mobileFrequency:3});(async()=>x.isNativePlatform()?(await St(),await Tt()):$.initDesktopBanner())();Y==null||Y.addEventListener("click",async()=>{x.isNativePlatform()||await $.maybeShowMobileInterstitial(),g.newGame(),B(),ne()});K==null||K.addEventListener("click",async()=>{x.isNativePlatform()||await $.maybeShowMobileInterstitial(),g.newGame(),B(),ae()});je(s=>{g.step(s),B(),ae(),Oe()});$e(Ce,s=>{g.step(s),B(),ae(),Oe()});const J=Xe();if(J)try{g.board.loadFrom(J.cells)(g).score=J.score,g.render(),B()}catch{g.newGame(),B()}else g.newGame(),B();function ae(){const s=g.snapshot();Je(s)}function Oe(){g.inputLocked||g.board.canMove()||setTimeout(()=>{st(P,g.score).then(async s=>{Qe(),s==="new"&&(x.isNativePlatform()||await $.maybeShowMobileInterstitial(),g.newGame(),B())})},20)}const kt=!0;function _t(){try{return window.self!==window.top}catch{return!0}}function be(){if(document.getElementById("pwaBanner"))return;const s=document.createElement("div");s.id="pwaBanner",s.style.cssText=`
    position: fixed; right: 12px; bottom: 12px; z-index: 9999;
    background: #0f1720; border: 1px solid #1a2330; color: #e6f1ff;
    padding: 10px 12px; border-radius: 12px; box-shadow: 0 10px 24px rgba(0,0,0,.25);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; font-size: 14px;
    display: flex; gap: 10px; align-items: center;
  `,s.innerHTML=`
    <span>Para instalar como app, abra fora do iframe.</span>
    <button id="openStandalone" style="
      padding: 8px 10px; border-radius: 10px; border: 1px solid #253140;
      background: linear-gradient(180deg,#39c0ff,#2aa8e2); color: #02131c; font-weight: 800; cursor: pointer;
    ">Abrir versão PWA</button>
  `,document.body.appendChild(s),document.getElementById("openStandalone").addEventListener("click",()=>{window.open(location.href,"_blank","noopener")})}(async()=>{var e,t;const s=x.isNativePlatform();if("serviceWorker"in navigator)if(!s&&kt&&!_t())try{await navigator.serviceWorker.register("sw.js")}catch(i){console.warn("SW register failed:",i)}else(t=(e=navigator.serviceWorker).getRegistrations)==null||t.call(e).then(i=>i.forEach(a=>a.unregister())),"caches"in globalThis&&caches.keys().then(i=>i.forEach(a=>caches.delete(a))),s||be();else s||be()})();ct(P,s=>{s&&$.initDesktopBanner()});function ye(s){const e=document.getElementById("privacyLink");e&&e.addEventListener("click",t=>{var i;(i=t.preventDefault)==null||i.call(t),lt(s)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>ye(P)):ye(P);export{pe as A,Ie as W};
